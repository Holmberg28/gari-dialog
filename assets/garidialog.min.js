let openGariDialogs=false,currentBackdrop=null;function GariDialog({title:title="",text:text="",html:html="",color:color="primary",icon:icon="",actions:actions={},actionsColor:actionsColor="",backdrop:backdrop="blur",size:size="lg",close:close="Close",escape:escape=true,autoSelect:autoSelect=true,promptInput:promptInput=[]}={}){return new Promise(e=>{openGariDialogs&&currentBackdrop?closeDialog(currentBackdrop,()=>t()):t();function t(){openGariDialogs=!0;const n={primary:"#027be3",secondary:"#6c757d",success:"#21ba45",danger:"#c10015",warning:"#f2c037",info:"#0dcaf0",light:"#f8f9fa",dark:"#212529"},o=color.startsWith("#")?color:n[color]||n.primary;actionsColor||(actionsColor=color);const c=document.createElement("div");c.className="gari-backdrop","blur"!==backdrop&&(c.style.backdropFilter="none",c.style.background=backdrop),currentBackdrop=c;const r=document.createElement("div");r.className=`gari-card gari-size-${size}`,c.appendChild(r);const i=document.createElement("div");i.className="fullscreen"===size?"gari-fullscreen-content":"gari-card-section",r.appendChild(i);const a=document.createElement("div");if(a.className="gari-header-row",i.appendChild(a),icon&&a.appendChild(createIconElement(icon,o)),title){const e=document.createElement("h4");e.textContent=title,a.appendChild(e)}const l=document.createElement("div");l.className="gari-content",html?l.insertAdjacentHTML("beforeend",html):text&&l.insertAdjacentHTML("beforeend",`<p>${text}</p>`),promptInput.forEach(e=>l.appendChild(createPromptInput(e.type,e.placeholder,e.defaultValue,e.label))),i.appendChild(l);const d=document.createElement("div");d.className="fullscreen"===size?"gari-fullscreen-actions":"gari-card-actions",r.appendChild(d);if(close){const t=document.createElement("button");t.className="gari-btn",t.style.setProperty("--btn-color",n[actionsColor]||actionsColor),t.textContent=close,t.addEventListener("click",()=>closeDialog(c,()=>e({closed:!0}))),d.appendChild(t)}let s=0;for(const t in actions){if(s>=4)break;const o=document.createElement("button");o.className="gari-btn",o.style.setProperty("--btn-color",n[actionsColor]||actionsColor),o.textContent=actions[t],o.addEventListener("click",()=>{const n={};promptInput.forEach((e,t)=>{const o=l.querySelectorAll(".gari-prompt-input")[t];n[e.name||t]=o?.value??null}),closeDialog(c,()=>e({[t]:!0,inputs:n}))}),d.appendChild(o),s++}autoSelect&&setTimeout(()=>{const e=d.querySelector(".gari-btn:last-child")||r.querySelector(".gari-close-btn");e&&e.focus()},80),"fullscreen"===size&&r.querySelector(".gari-close-btn")?.addEventListener("click",()=>closeDialog(c,()=>e({closed:!0}))),escape&&document.addEventListener("keydown",function t(n){"Escape"===n.key&&(closeDialog(c,()=>e({closed:!0})),document.removeEventListener("keydown",t))}),document.body.appendChild(c)}})}
function closeDialog(e,t){openGariDialogs=!1,e.classList.add("gari-fade-out"),setTimeout(()=>{e.remove(),t&&t()},200)}
function createIconElement(e,t){const o=document.createElement("div");o.className="gari-avatar",o.style.background=t;let n;if(!e)return o;e.startsWith("fa-")||e.startsWith("fa ")?n=Object.assign(document.createElement("i"),{className:`fa ${e}`}):e.startsWith("bi-")?n=Object.assign(document.createElement("i"),{className:`bi ${e}`}):1===e.length||e.match(/\p{Emoji}/u)?Object.assign(n=document.createElement("span"),{textContent:e,style:"font-size:24px"}):Object.assign(n=document.createElement("i"),{className:"material-symbols-rounded",textContent:e});return o.appendChild(n),o}
function createPromptInput(e,t="",o="",n="",c=""){const r=document.createElement("div");r.className="gari-prompt-wrapper";if(n){const e=document.createElement("label");e.textContent=n,r.appendChild(e)}const i="textarea"===e?Object.assign(document.createElement("textarea"),{rows:4}):Object.assign(document.createElement("input"),{type:["number","email","password"].includes(e)?e:"text"});return i.placeholder=t,i.value=o,i.name=c,i.className="gari-prompt-input",r.appendChild(i),r}
